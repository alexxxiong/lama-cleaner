# 国际化实施任务列表

## 第一阶段：基础设施搭建

- [x] 1. 安装国际化依赖包 ✅
  - 在 lama_cleaner/app 目录下安装 react-i18next、i18next、i18next-browser-languagedetector 和 i18next-http-backend
  - 更新 package.json 文件中的依赖版本
  - 运行 pnpm install 确保所有依赖正确安装
  - _需求: 1.1, 1.3_

- [x] 2. 创建 i18n 配置文件和初始化 ✅
  - [x] 2.1 创建 src/i18n/index.ts 配置文件 ✅
    - 实现 i18n 初始化配置，包括语言检测、回退语言设置、插值配置
    - 配置支持的语言列表（en, zh-CN）
    - 设置资源加载路径和缓存策略
    - _需求: 1.1, 1.2, 1.4_
  
  - [x] 2.2 在 App.tsx 中集成 i18n Provider ✅
    - 导入 i18n 配置文件
    - 在 React 应用根组件中初始化 i18n
    - 确保 i18n 在 RecoilRoot 内部初始化
    - _需求: 1.1, 1.5_

- [x] 3. 创建 TypeScript 类型定义 ✅
  - [x] 3.1 创建 src/i18n/types.ts 类型文件 ✅
    - 定义翻译资源的 TypeScript 接口
    - 为每个命名空间（common, editor, settings, errors, shortcuts）创建类型定义
    - 导出类型供组件使用
    - _需求: 6.3, 7.1_
  
  - [x] 3.2 创建类型安全的翻译 Hook ✅
    - 实现 useTypedTranslation 自定义 Hook
    - 提供类型安全的翻译函数接口
    - 编写单元测试验证类型安全性
    - _需求: 7.1, 7.3_

## 第二阶段：翻译资源组织

- [x] 4. 创建翻译文件结构 ✅
  - [x] 4.1 创建英文翻译文件 ✅
    - 创建 src/i18n/resources/en/common.json
    - 创建 src/i18n/resources/en/editor.json  
    - 创建 src/i18n/resources/en/settings.json
    - 创建 src/i18n/resources/en/errors.json
    - 创建 src/i18n/resources/en/shortcuts.json
    - _需求: 6.1, 6.2_
  
  - [x] 4.2 创建中文翻译文件 ✅
    - 创建 src/i18n/resources/zh-CN/common.json
    - 创建 src/i18n/resources/zh-CN/editor.json
    - 创建 src/i18n/resources/zh-CN/settings.json
    - 创建 src/i18n/resources/zh-CN/errors.json
    - 创建 src/i18n/resources/zh-CN/shortcuts.json
    - _需求: 6.1, 6.2_

- [x] 5. 提取现有文本到翻译文件 ✅ (部分完成)
  - [x] 5.1 扫描并提取 common 命名空间的文本 ✅
    - 提取按钮文本（Save, Cancel, Upload 等）
    - 提取导航标签文本
    - 提取通用工具提示文本
    - _需求: 3.1, 3.2, 3.3_
  
  - [x] 5.2 扫描并提取 editor 命名空间的文本 ✅
    - 提取编辑器工具名称
    - 提取编辑器操作提示
    - 提取图像处理相关文本
    - _需求: 3.3, 5.4_
  
  - [x] 5.3 扫描并提取 settings 命名空间的文本 ✅
    - 提取设置面板标题和描述
    - 提取 AI 模型名称和说明
    - 提取参数标签和提示
    - _需求: 3.4, 5.1, 5.2_

## 第三阶段：状态管理集成

- [x] 6. 集成 Recoil 状态管理 ✅
  - [x] 6.1 创建语言状态 Atom ✅
    - 在 src/store/Atoms.tsx 中添加 languageState atom
    - 实现 localStorage 持久化效果
    - 实现与 i18n 的双向同步
    - _需求: 2.3, 2.4, 7.5_
  
  - [x] 6.2 创建 useLanguage Hook ✅
    - 实现语言切换功能
    - 处理语言切换错误
    - 提供支持的语言列表
    - _需求: 2.2, 2.5_

- [x] 7. 创建语言切换器组件 ✅
  - [x] 7.1 实现 LanguageSwitcher 组件 ✅
    - 创建 src/components/Header/LanguageSwitcher.tsx
    - 使用 Radix UI Select 组件实现下拉选择
    - 集成 useLanguage Hook
    - _需求: 2.1, 2.2_
  
  - [x] 7.2 集成语言切换器到 Header ✅
    - 在 Header 组件中添加 LanguageSwitcher
    - 放置在主题切换器旁边
    - 添加适当的样式和图标
    - _需求: 2.1, 3.1_

## 第四阶段：核心组件迁移

- [x] 8. 迁移 Toast 和错误消息 ✅
  - [x] 8.1 更新 Toast 组件支持国际化 ✅
    - 修改 setToastState 调用以使用翻译键
    - 实现动态内容插值支持
    - 测试错误消息显示
    - _需求: 4.1, 4.2, 4.3_
  
  - [x] 8.2 迁移所有错误消息 ✅
    - 查找并替换所有硬编码的错误文本
    - 添加文件上传错误的翻译
    - 添加 API 错误的翻译
    - _需求: 4.3, 4.4, 4.5_

- [x] 9. 迁移 Header 组件 ✅
  - [x] 9.1 替换 Header 中的硬编码文本 ✅
    - 使用 useTranslation Hook
    - 替换导航项文本
    - 替换按钮工具提示
    - _需求: 3.1_
  
  - [x] 9.2 迁移文件操作相关文本 ✅
    - 替换 "Open File Manager" 等文本
    - 替换上传相关提示文本
    - 测试文件操作功能
    - _需求: 3.1, 3.5_

- [x] 10. 迁移 LandingPage 组件 ✅
  - [x] 10.1 替换欢迎页面文本 ✅
    - 迁移欢迎消息
    - 迁移操作提示文本
    - 迁移拖放区域文本
    - _需求: 3.2_
  
  - [x] 10.2 处理动态内容 ✅
    - 实现文件大小限制的动态显示
    - 测试不同语言下的显示效果
    - _需求: 3.2, 4.2_

## 第五阶段：设置界面迁移

- [x] 11. 迁移 Settings 组件 ✅
  - [x] 11.1 迁移设置面板基础文本 ✅
    - 替换模态框标题
    - 替换选项卡标签
    - 替换按钮文本
    - _需求: 3.4_
  
  - [x] 11.2 迁移 AI 模型设置 ✅
    - 实现模型名称的本地化
    - 实现模型描述的本地化
    - 处理技术参数说明
    - _需求: 5.1, 5.2_
  
  - [x] 11.3 迁移参数设置 ✅
    - 替换参数标签
    - 替换参数提示文本
    - 处理数值范围说明
    - _需求: 3.4, 5.2_

## 第六阶段：编辑器界面迁移

- [x] 12. 迁移 Editor 组件 ✅
  - [x] 12.1 迁移编辑器工具栏 ✅
    - 替换工具名称（Reset Zoom, Undo, Redo 等）
    - 替换工具提示文本
    - 测试工具功能
    - _需求: 3.3_
  
  - [x] 12.2 迁移编辑器消息和提示 ✅
    - 替换 "Please draw mask" 等提示
    - 替换处理状态消息
    - 实现进度消息的动态插值
    - _需求: 3.3, 4.4_
  
  - [x] 12.3 迁移 InteractiveSeg 组件 ✅
    - 替换交互式分割工具文本
    - 替换操作说明文本
    - _需求: 3.3_

## 第七阶段：高级功能迁移

- [x] 13. 迁移 FileManager 组件 ✅
  - 替换文件浏览器界面文本
  - 替换文件操作相关文本
  - 测试文件管理功能
  - _需求: 3.5_

- [x] 14. 迁移键盘快捷键说明 ✅
  - [x] 14.1 迁移 Shortcuts 模态框 ✅
    - 替换快捷键描述文本
    - 按类别组织快捷键翻译
    - _需求: 5.5_
  
  - [x] 14.2 更新快捷键工具提示 ✅
    - 在相关组件中更新快捷键提示
    - 确保快捷键说明一致性
    - _需求: 5.5_

- [x] 15. 迁移 SidePanel 组件 ✅
  - 替换侧边栏工具面板文本
  - 替换 SD、Paint-by-Example 等工具文本
  - 替换插件相关文本
  - _需求: 3.3, 5.4_

## 第八阶段：性能优化和测试

- [ ] 16. 实现性能优化
  - [ ] 16.1 配置翻译资源懒加载
    - 实现按需加载命名空间
    - 配置资源缓存策略
    - 测试加载性能
    - _需求: 8.2, 8.4_
  
  - [ ] 16.2 优化组件渲染
    - 使用 React.memo 优化翻译组件
    - 避免不必要的重渲染
    - 测试语言切换性能
    - _需求: 8.1, 8.3_

- [ ] 17. 编写测试用例
  - [ ] 17.1 编写单元测试
    - 测试 useLanguage Hook
    - 测试 useTypedTranslation Hook
    - 测试语言切换逻辑
    - _需求: 7.2_
  
  - [ ] 17.2 编写组件测试
    - 测试 LanguageSwitcher 组件
    - 测试各组件的国际化渲染
    - 测试错误处理
    - _需求: 4.5, 7.2_
  
  - [ ] 17.3 编写集成测试
    - 测试完整的语言切换流程
    - 测试翻译资源加载
    - 测试持久化功能
    - _需求: 2.4, 6.4, 8.5_

## 第九阶段：文档和收尾

- [ ] 18. 完善翻译内容
  - [ ] 18.1 审查英文翻译完整性
    - 检查所有翻译键是否都有对应的英文文本
    - 修复缺失的翻译
    - 统一术语使用
    - _需求: 6.4_
  
  - [ ] 18.2 完成中文翻译
    - 翻译所有英文文本到中文
    - 审查翻译质量和一致性
    - 处理专业术语的翻译
    - _需求: 5.3, 6.4_

- [ ] 19. 开发者文档
  - 创建国际化开发指南
  - 记录如何添加新的翻译键
  - 记录如何添加新的语言支持
  - _需求: 7.3_

- [x] 20. 最终验证 ✅
  - [x] 20.1 执行完整的端到端测试 ✅
    - 测试所有页面的语言切换
    - 验证布局适应性
    - 测试边界情况
    - _需求: 8.3, 8.5_
  
  - [x] 20.2 性能验证 ✅
    - 验证语言切换响应时间 < 500ms
    - 验证初始包大小增量合理
    - 验证内存使用情况
    - _需求: 8.1, 8.2_